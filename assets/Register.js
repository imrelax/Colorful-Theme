import{u as F,r as v,a as T,o as j,c as y,b as s,d as _,g as x,t as l,e as o,w as n,f as p,h as M,i as h,j as R,k as E,l as k,m as u}from"./index.js";import{g as P,s as D,r as G}from"./auth.js";import{C as L}from"./Captcha.js";import{_ as H}from"./_plugin-vue_export-helper.js";const J={class:"dark-tech-auth"},K={class:"auth-grid"},O={class:"branding-side"},Q={class:"brand-content"},W={class:"logo-container"},X=["src","alt"],Y={key:1,class:"brand-title"},Z={class:"brand-desc"},ee={class:"features"},ae={class:"feature-badge"},se={class:"feature-badge"},te={class:"form-side"},oe={class:"glass-card form-container"},le={class:"form-header"},re={class:"code-input-group"},ie={class:"form-footer"},ne={href:"#/login",class:"link-primary"},de={__name:"Register",setup(ue){const{t:r}=F(),c=x(),N=M(),g=v(!1),m=v({}),w=v(null),U=e=>{w.value=e},t=T({email:"",password:"",re_password:"",email_code:"",agreement:!0}),f=v(0);let $=null;const V=async()=>{if(!t.email)return u.error(r("validation.emailRequired"));try{await D({email:t.email}),u.success(r("auth.codeSent")),f.value=60,$=setInterval(()=>{f.value--,f.value<=0&&clearInterval($)},1e3)}catch(e){u.error(e.message||r("auth.sendFailed"))}};j(async()=>{try{const e=await P();e.data&&(m.value=e.data)}catch(e){console.error("Failed to fetch config:",e)}});const q=async(e,a)=>{if(!a)throw new Error("è¯·æŽ¥å—æœåŠ¡æ¡æ¬¾")},B=async(e,a)=>{if(!a)throw new Error("è¯·è¾“å…¥é‚®ç®±");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a))throw new Error(r("validation.emailInvalid"));if(m.value.email_whitelist_suffix&&Array.isArray(m.value.email_whitelist_suffix)){const d=a.split("@")[1];if(!m.value.email_whitelist_suffix.includes(d))throw new Error(r("validation.emailSuffixNotAllowed",{suffixes:m.value.email_whitelist_suffix.join(", ")}))}},I=async e=>{if(c.enableCaptcha){if(w.value===null)return u.error(r("auth.enterCaptcha"));if(w.value===!1)return u.error(r("auth.captchaInvalid"))}if(e.password!==e.re_password)return u.error(r("validation.passwordMismatch"));g.value=!0;try{(await G(e)).data&&(u.success(r("auth.registerSuccess")),N.push("/login"))}catch{}finally{g.value=!1}};return(e,a)=>{const b=p("a-input"),d=p("a-form-item"),C=p("a-button"),S=p("a-input-password"),z=p("a-checkbox"),A=p("a-form");return h(),y("div",J,[s("div",K,[s("div",O,[s("div",Q,[s("div",W,[a[5]||(a[5]=s("div",{class:"logo-glow"},null,-1)),_(c).logoUrl?(h(),y("img",{key:0,src:_(c).logoUrl,alt:_(c).siteName,class:"brand-logo-image"},null,8,X)):(h(),y("h1",Y,"åŠ å…¥ "+l(_(c).siteName),1))]),s("p",Z,l(e.$t("auth.registerSubtitle")),1),s("div",ee,[s("div",ae,[a[6]||(a[6]=s("div",{class:"badge-icon"},"ðŸ›¡ï¸",-1)),s("span",null,l(e.$t("auth.privacyProtection")),1)]),s("div",se,[a[7]||(a[7]=s("div",{class:"badge-icon"},"âš¡",-1)),s("span",null,l(e.$t("auth.unlimitedTraffic")),1)])])])]),s("div",te,[s("div",oe,[s("div",le,[s("h2",null,l(e.$t("auth.registerButton")),1),s("p",null,l(e.$t("auth.registerSubtitle")),1)]),o(A,{model:t,onFinish:I,layout:"vertical"},{default:n(()=>[o(d,{label:e.$t("auth.email"),name:"email",rules:[{validator:B}]},{default:n(()=>[o(b,{value:t.email,"onUpdate:value":a[0]||(a[0]=i=>t.email=i),placeholder:"your@email.com",size:"large"},null,8,["value"])]),_:1},8,["label","rules"]),m.value.is_email_verify?(h(),R(d,{key:0,label:"é‚®ç®±éªŒè¯ç ",name:"email_code",rules:[{required:!0,message:"è¯·è¾“å…¥é‚®ç®±éªŒè¯ç "}],class:"code-item"},{default:n(()=>[s("div",re,[o(b,{value:t.email_code,"onUpdate:value":a[1]||(a[1]=i=>t.email_code=i),placeholder:"è¾“å…¥éªŒè¯ç ",size:"large"},null,8,["value"]),o(C,{type:"primary",class:"send-code-btn",disabled:f.value>0||!t.email,onClick:V},{default:n(()=>[k(l(f.value>0?`${f.value}s`:"å‘é€éªŒè¯ç "),1)]),_:1},8,["disabled"])])]),_:1})):E("",!0),o(d,{label:e.$t("auth.password"),name:"password",rules:[{required:!0,message:e.$t("validation.passwordRequired")}]},{default:n(()=>[o(S,{value:t.password,"onUpdate:value":a[2]||(a[2]=i=>t.password=i),placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",size:"large"},null,8,["value"])]),_:1},8,["label","rules"]),o(d,{label:e.$t("auth.confirmPassword"),name:"re_password",rules:[{required:!0,message:e.$t("validation.passwordRequired")}]},{default:n(()=>[o(S,{value:t.re_password,"onUpdate:value":a[3]||(a[3]=i=>t.re_password=i),placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",size:"large"},null,8,["value"])]),_:1},8,["label","rules"]),_(c).enableCaptcha?(h(),R(L,{key:1,onVerify:U})):E("",!0),o(d,{name:"agreement",rules:[{validator:q}]},{default:n(()=>[o(z,{checked:t.agreement,"onUpdate:checked":a[4]||(a[4]=i=>t.agreement=i)},{default:n(()=>[k(l(e.$t("auth.agreement")),1)]),_:1},8,["checked"])]),_:1},8,["rules"]),o(C,{type:"primary","html-type":"submit",loading:g.value,block:"",size:"large"},{default:n(()=>[k(l(e.$t("auth.registerButton")),1)]),_:1},8,["loading"])]),_:1},8,["model"]),s("div",ie,[s("span",null,l(e.$t("auth.hasAccount")),1),s("a",ne,l(e.$t("auth.backToLogin")),1)])])])])])}}},_e=H(de,[["__scopeId","data-v-fe2f780d"]]);export{_e as default};
