import{u as F,r as p,k as M,j as P,a as O,c as r,b as s,m as y,e as d,d as i,t as o,F as _,y as b,f as R,h as A,o as l,v as g}from"./index.js";import{d as E,s as L}from"./user.js";import{_ as V}from"./_plugin-vue_export-helper.js";import{Z as $}from"./zap.js";import{C as j}from"./circle-check-big.js";import{R as J}from"./refresh-cw.js";import{A as Z}from"./arrow-right.js";import"./createLucideIcon.js";const D={class:"dark-tech-plans animate-fade-in"},x={class:"page-header"},G={class:"header-icon"},H={key:0,class:"plans-grid"},K={key:0,class:"featured-badge"},Q={class:"plan-header"},T={class:"plan-name"},U={class:"plan-cycle-selector"},W=["onClick"],X={class:"plan-price"},Y={class:"amount"},ee={class:"period"},se={class:"plan-features"},ae={class:"plan-footer"},te=["onClick","disabled"],re={key:1,class:"loading-state"},le={key:2,class:"empty-state"},ce={__name:"Plans",setup(oe){const z=A(),{t:C}=F();p([]);const u=p(!0),h=p(!1),v=p(null),f={month_price:{label:"dashboard.plans.cycles.month_price",value:"month_price"},quarter_price:{label:"dashboard.plans.cycles.quarter_price",value:"quarter_price"},half_year_price:{label:"dashboard.plans.cycles.half_year_price",value:"half_year_price"},year_price:{label:"dashboard.plans.cycles.year_price",value:"year_price"},two_year_price:{label:"dashboard.plans.cycles.two_year_price",value:"two_year_price"},three_year_price:{label:"dashboard.plans.cycles.three_year_price",value:"three_year_price"},onetime_price:{label:"dashboard.plans.cycles.onetime_price",value:"onetime_price"},reset_price:{label:"dashboard.plans.cycles.reset_price",value:"reset_price"}},m=p([]);M(()=>{B(),I()});const B=()=>{try{const e=localStorage.getItem("xboard_plan_list");e&&(k(JSON.parse(e)),u.value=!1)}catch(e){console.error("Plans cache load error:",e)}},I=async()=>{try{const e=await E();e.data&&(k(e.data),localStorage.setItem("xboard_plan_list",JSON.stringify(e.data)))}catch{P.error("åŠ è½½å¥—é¤å¤±è´¥")}finally{u.value=!1}},k=e=>{const t=new Map;e.forEach(n=>{if(!t.has(n.id)){const a=[];Object.keys(f).forEach(c=>{n[c]!==null&&n[c]!==void 0&&a.push(f[c])}),t.set(n.id,O({...n,availableCycles:a,selectedCycle:a.length>0?a[0].value:null}))}}),m.value=Array.from(t.values())},N=e=>e.selectedCycle?(e[e.selectedCycle]/100).toFixed(2):"0.00",S=e=>{var t;return((t=f[e])==null?void 0:t.label)||""},q=async e=>{if(e.selectedCycle){h.value=!0,v.value=e.id;try{const t=await L({plan_id:e.id,period:e.selectedCycle});t.data&&(P.success("è®¢å•å·²åˆ›å»º"),z.push({path:"/order",query:{trade_no:t.data}}))}catch{}finally{h.value=!1,v.value=null}}};return(e,t)=>{const n=R("a-spin");return l(),r("div",D,[s("div",x,[s("div",G,[d(i($),{size:32})]),s("h1",null,o(e.$t("dashboard.plans.title")),1),s("p",null,o(e.$t("dashboard.plans.description")),1)]),u.value?y("",!0):(l(),r("div",H,[(l(!0),r(_,null,b(m.value,a=>(l(),r("div",{key:a.id,class:g(["plan-card glass-card",{featured:a.show}])},[a.show?(l(),r("div",K,[d(i($),{size:12}),s("span",null,o(e.$t("dashboard.plans.featured")),1)])):y("",!0),s("div",Q,[s("h3",T,o(a.name),1),s("div",U,[(l(!0),r(_,null,b(a.availableCycles,c=>(l(),r("div",{key:c.value,class:g(["cycle-btn",{active:a.selectedCycle===c.value}]),onClick:w=>a.selectedCycle=c.value},o(i(C)(c.label)),11,W))),128))]),s("div",X,[t[0]||(t[0]=s("span",{class:"currency"},"Â¥",-1)),s("span",Y,o(N(a)),1),s("span",ee,"/ "+o(i(C)(S(a.selectedCycle))),1)])]),s("div",se,[(l(!0),r(_,null,b((a.content||"").split(`
`),(c,w)=>(l(),r("div",{class:"feature-item",key:w},[d(i(j),{size:16,class:"check-icon"}),s("span",null,o(c),1)]))),128))]),s("div",ae,[s("button",{class:g(["buy-btn",{featured:a.show}]),onClick:c=>q(a),disabled:h.value},[h.value&&v.value===a.id?(l(),r(_,{key:0},[d(i(J),{class:"animate-spin",size:18}),s("span",null,o(e.$t("dashboard.plans.processing")),1)],64)):(l(),r(_,{key:1},[s("span",null,o(e.$t("dashboard.plans.subscribe")),1),d(i(Z),{size:18})],64))],10,te)])],2))),128))])),u.value?(l(),r("div",re,[d(n,{size:"large"})])):y("",!0),!u.value&&m.value.length===0?(l(),r("div",le,[t[1]||(t[1]=s("div",{class:"empty-icon"},"ðŸ“‚",-1)),s("p",null,o(e.$t("dashboard.plans.noPlans")),1)])):y("",!0)])}}},ve=V(ce,[["__scopeId","data-v-4e63e3db"]]);export{ve as default};
